var TotalJobsGroup=TotalJobsGroup||{};TotalJobsGroup.Personalisation=TotalJobsGroup.Personalisation||{},TotalJobsGroup.Personalisation.RecommendedJobs=TotalJobsGroup.Personalisation.RecommendedJobs||{},TotalJobsGroup.Personalisation.RecommendedJobs.DataService=function(e){"use strict";function n(e,n,t){return null===e||"undefined"==typeof e||""===e?o(analytics.RecommendedJobsOrigin,n,t):o(e,n,t)}function o(n,o,t){return e.ajax({type:"GET",data:{origin:n,halo:o,lastAppliedJobId:t},url:a.getRecommendationsServiceUrl,contentType:"text/html; charset=utf-8",timeout:a.timeout})}function t(n){return e.ajax({type:"POST",url:a.discardJobServiceUrl,data:{jobId:n},timeout:a.timeout})}var a={getRecommendationsServiceUrl:"/Personalisation/RecommendedJobs",discardJobServiceUrl:"/Personalisation/RecommendedJobs/Dismiss",timeout:"10000"};return{getRecommendations:n,discardJob:t}}(jQuery),TotalJobsGroup.Personalisation.RecommendedJobs.Helpers=function(){"use strict";function e(e,n){var o=e.closest(".rj-results-container");void 0!==n&&n.length>0?o.hasClass("hidden")&&o.removeClass("hidden"):o.hasClass("hidden")||o.addClass("hidden")}function n(e){"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log(e)}function o(){return window.TransitionEvent}return{showRecommendedJobsSectionIfWeHaveData:e,log:n,isCssAnimationSupported:o}}(),TotalJobsGroup.Personalisation.RecommendedJobs=function(e,n,o){"use strict";function t(){e(".rj-jobs-list").children("."+V).first().addClass(C).removeClass(V)}function a(e){return{jobId:e.attr("data-job-id"),dataRank:e.attr("data-rank")}}function i(){return L}function r(e){"complete"===document.readyState?e():window.addEventListener("load",function(n){e()})}function d(n){var a=e("#"+n.jobId),i=a.index();o.isCssAnimationSupported()?(E||e(".rj-jobs-list>div:eq("+i+")").addClass("animated bounceOutLeft"),P?window.innerWidth>=460&&(i>2?e(".rj-jobs-list>div:gt("+i+")").addClass("animated moveLeft"):e(".rj-jobs-list>div:gt("+i+"):lt("+(2-i)+")").addClass("animated moveLeft")):T()||E||e(".rj-jobs-list>div:gt("+i+")").addClass("animated moveLeft"),E||setTimeout(function(){e(".rj-jobs-list>div:gt("+i+")").removeClass("animated moveLeft"),t(),a.remove()},750)):(t(),a.remove())}function l(o){o.preventDefault(),e(this).addClass("skipped"),G++,L--;var t=a(e(this));m(),d(t),n.discardJob(t.jobId,t.dataRank).fail()}function c(n){G++,L--;var o=e(n)[0],t={jobId:o.id,dataRank:0};m(),d(t)}function u(){e(w).one("click",".left-box button",l)}function m(){1===L?e(".rj-list-title").html('<span class="hidden-sm hidden-md hidden-lg">1</span> Recommended job'):e(".rj-list-title").html('<span class="hidden-sm hidden-md hidden-lg">'+L+"</span> Recommended jobs")}function v(){window.SavedJobsManager=window.SavedJobsManager||SavedJobs.Manager(e);var n=SavedJobs.Events(e,window.SavedJobsManager);e('div[id^="rj-results"]').on("update",".btn-savejob",function(n,o){void 0!==o&&o.isInitialUpdate===!0||e(this).hasClass("saved")&&(c(this),k())}),n.bindEvents(),n.triggerEvents({isInitialUpdate:!0});var o=window.Toast;o.bindEvents()}function b(){var e="event901,event16",n=s_gi(analLib.getSiteId());n.linkTrackVars="eVar23,eVar30,events",n.linkTrackEvents=e,n.events=e,n.tl(analLib,"o","Recommended Job Saved")}function f(){var e="event950",n=s_gi(analLib.getSiteId());n.linkTrackVars="eVar23,eVar30,events",n.linkTrackEvents=e,n.events=e,n.tl(analLib,"o","Recommended Job Discarded")}function p(){var e="event19",n=s_gi(analLib.getSiteId());n.linkTrackVars="eVar23,eVar30,events",n.linkTrackEvents=e,n.events=e,n.tl(analLib,"o","Recommender_QuickView")}function h(n,o,t){var a=e(n),i=a.data("external"),s=i===!0?"event28":"event28,event35",r=s_gi(analLib.getSiteId());r.linkTrackVars="eVar23,eVar30,events",r.linkTrackEvents=s,r.events=s,r.tl(analLib,"o",t),o&&(a.css("pointer-events","none"),a.text("Applied"))}function g(){var e=s_gi(analLib.getSiteId());e.linkTrackVars="eVar23",e.tl(analLib,"0","Recommended Job - Company Search Click"),e.props=""}function J(t,a,i,d){n.getRecommendations(a,i,d).success(function(n,a,d){if(200===d.status)try{var l=e(n),c=3;(P||E)&&(c=6),l.find(w).slice(0,c).addClass(C).removeClass(V),t.html(l),L=e(y).length-1,m(),u(),v(),void 0===s.eVar23&&(s.eVar23=s.pageName),e("input.btn-send-application").each(function(){e(this).on("click",function(){h(this,!0,"Click on Apply")})}),e("a.rj-edit-app").each(function(){var n=e(this).hasClass("rj-quickview-apply")?"Click on Apply - Confirmation Recommender QuickView":"Click on Apply";e(this).on("click",function(){h(this,!1,n)})}),e(".rj-secondary-actions .btn-savejob").each(function(){1!==e(this).parents("div .searchresults-jobbar-recommenderjobs").length&&1!==e(this).parents("div #details-recommender").length&&e(this).on("click",function(){b()})}),e(".company-link").each(function(){e(this).on("click",function(){g()})}),e(".rj-skip-btn").each(function(){e(this).on("click",function(){f()})}),e(".rj-quick-view-link").each(function(){e(this).on("click",function(){p()})})}finally{r(T()?function(){analLib.fireRecomendedJobsEvents("event74","Recommended Jobs Served - Search Results Bottom",j())}:S()?function(){analLib.fireRecomendedJobsEvents("event74","Recommended Jobs Served - Job Details Similar To Search",j())}:function(){if(O){var e,n=s_gi(analLib.getSiteId()),o="event74",t=j();e=i?"HALO V2":"Control",null!=n&&(n.linkTrackVars="eVar23,eVar78,prop65,event74",n.linkTrackEvents=o,n.prop65=t,n.eVar78=e,n.events=o,n.tl(!0,"o","Recommended Jobs Served"),localStorage&&(localStorage.prop65=t),n.linkTrackEvents=null,n.events=null)}else analLib.fireRecomendedJobsEvents("event74","Recommended Jobs Served",j())}),t.trigger("recommender-rendered")}else 204===d.status?o.log("No jobs found"):o.log("An error occurred :o| ["+a+"]")}).fail(function(e){o.log("An error occurred :o( ["+e.status+"]")})}function j(){var n=e(".rj-row-holder:visible"),o=n.length,t=n.find(".rj-hero:not(.watermark)").length;return o===t?"All":0===t?"None":t}function k(){var e=window.SavedJobsManager;e&&e.trackOnSitecatalyst("event901","Recommended Job Saved")}function T(){var n,o,t=e(".rj-results-container")[0];return e.isNullOrUndefined(t)||e.isNullOrUndefined(t.dataset)||(n=t.dataset,o=n.issearchrecommender),!e.isNullOrUndefined(o)&&"True"===o}function S(){return"JobDetailsPageSimilarToSearch"===e("#details-recommender").data("origin")}function R(){var n=e("#recommended-jobs-placeholder"),o=e("#details-recommender");return o.length?void J(o,o.data("origin"),null,null):void(n.length&&J(n,n.data("origin"),n.data("halo"),n.data("lastappliedjobid")))}var w=".rj-row-holder",y=".rj-job-container",C="rj-visible-row",V="rj-hidden-row",L=0,G=0,P=window.location.href.indexOf("/apply/confirmation")!==-1,E=window.location.href.indexOf("/job/")!==-1&&!P,I=window.location.href.indexOf("www.totaljobs")!==-1,O=P&&I;return e(document).ready(R),{retrieveRecommendations:J,getNumberOfRecommendedJobs:i}}(jQuery,TotalJobsGroup.Personalisation.RecommendedJobs.DataService,TotalJobsGroup.Personalisation.RecommendedJobs.Helpers);var TotalJobsGroup=TotalJobsGroup||{};TotalJobsGroup.Personalisation=TotalJobsGroup.Personalisation||{},TotalJobsGroup.Personalisation.RecommendedJobs=TotalJobsGroup.Personalisation.RecommendedJobs||{},TotalJobsGroup.Personalisation.RecommendedJobs.Logging=function(e){var n=function(n,o,t){200===t.status&&e.ajax({url:"/personalisation/recommenderdatalogger/logdata",data:JSON.stringify({search:n}),contentType:"application/json; charset=utf-8",dataType:"json",type:"post",cache:!1})};this.log=function(o){var t="function"!=typeof o?o:o();if(t){var a=JSON.stringify(t);e.ajax({url:"/personalisation/recommenderdatastamper/stamp",data:{data:a},dataType:"json",type:"post"}).done(n)}},this.logToPersonalisation=n};
//# sourceMappingURL=recommended-jobs.min.js.map
