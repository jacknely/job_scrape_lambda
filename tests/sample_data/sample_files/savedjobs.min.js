var SavedJobs=SavedJobs||{};SavedJobs.Properties={CookieName:"JBM_COOKIE",JobsiteCookieName:"saved_jobs",DeclineCookieName:"PJBOPTIN",CookieDelimiter:",",JobsiteCookieDelimiter:":",MaxItems:99,EmptyText:"0 Saved jobs",FillText:"{0} Saved jobs",MaxItemsReachedText:"You can save a maximum of 99 jobs. Do you want to view your saved jobs now?",SavedJobsUrl:"/SavedJobs/",FillTextSingular:"1 Saved job"};var SavedJobs=SavedJobs||{};SavedJobs.Manager=function(e){function o(){var o=SavedJobs.Properties.CookieName,n=SavedJobs.Properties.CookieDelimiter,i=J.join(n);t(o,i),e(".jb-status").trigger("update")}function t(o,t){e.cookie(o,t,{path:"/",expires:365})}function n(){var o=SavedJobs.Properties.CookieName,t=SavedJobs.Properties.CookieDelimiter,n=e.cookie(o);if(null!==n&&"undefined"!=typeof n&&(n=n.toString()),n){var i=n;if(n.indexOf("|")>-1&&(i=n.split("|")[0]),null!==i&&"undefined"!=typeof i)return void(i.indexOf(t)>-1?J=i.split(t):(J=[],J[0]=i))}}function i(e){var o;for(o=0;o<J.length;o++)if(parseInt(J[o],10)===e)return o;return-1}function a(e){var o=i(e)>-1;return o}function r(){var o=SavedJobs.Properties.DeclineCookieName;return"decline"!==e.cookie(o)&&(e.cookie("cookietester","cookietesterdata"),"cookietesterdata"===e.cookie("cookietester")||"decline"!==e.cookie(o))&&(e.cookie("cookietester",null),!0)}function u(o){var t=e(o),n=t.data("external"),i=n===!0?"event28":"event28,event35",a=s_gi(analLib.getSiteId());a.linkTrackVars="eVar23,events",a.linkTrackEvents=i,a.events=i,a.tl(analLib,"o","Click on Apply")}function d(o){var t=e(o),n=t.data("referrer");e.ajax({url:"/savedjobs/storage/GetSavedJobs?jobTypes=applicable&amount=3&referrer="+n,success:function(e,i,a){if(200===a.status){o.html(e),t.on("click",".sj-oca, .sj-edit-app",function(){u(this)});var s="event75",r=s_gi(analLib.getSiteId());r.linkTrackVars="eVar23,eVar30,events",r.linkTrackEvents=s,r.events=s,r.eVar23=n,r.eVar30=analytics.MemberId,r.tl(analLib,"o","Saved Jobs Served")}}})}function c(t,a){var r=SavedJobs.Properties.MaxItems;n();var u=i(t);if(u===-1){var d=J.length;if(d>=r)return s.tl(this,"o","Max Saved Jobs Reached"),confirm(SavedJobs.Properties.MaxItemsReachedText)?void(window.location=SavedJobs.Properties.SavedJobsUrl):void b(!1);S(function(n){0===n?(J.push(t),o(),a(!0)):e.post("/savedjobs/storage/AddSavedJob",{jobId:t},function(e){l(e,a)},"json").fail(function(){a(!1)})})}}function v(t,a){n();var s=i(t);s>-1&&S(function(n){0===n?(J.splice(s,1),o(),a(!0)):e.post("/savedjobs/storage/RemoveSavedJob",{jobId:t},function(e){l(e,a)},"json").fail(function(){a(!1)})})}function l(e,t){var n=!1;null!==e&&(J=e,o(),n=!0),t(n)}function f(){return C}function b(e){C=e}function p(){return n(),J.length}function g(){return e.cookie(k)}function m(){g()&&e.cookie(k,null,{path:"/"})}function S(o){if("undefined"!=typeof TotalJobsGroup&&"undefined"!=typeof TotalJobsGroup.IsLoggedInFunction)o(TotalJobsGroup.IsLoggedInFunction());else if("undefined"!=typeof TotalJobsGroup&&7===TotalJobsGroup.Config.Site.Site)o("undefined"!=typeof e.cookie("SoftLoginCookie")&&null!=e.cookie("SoftLoginCookie")?1:0);else if("undefined"!=typeof TotalJobsGroup&&"undefined"!=typeof TotalJobsGroup.Header&&"function"==typeof TotalJobsGroup.Header.AccountDetails&&"undefined"!=typeof TotalJobsGroup.Config&&"undefined"!=typeof TotalJobsGroup.Config.Global){var t=new TotalJobsGroup.Header.AccountDetails(e,window.location,TotalJobsGroup.Config.Global,TotalJobsGroup.IsJobsiteBrand,TotalJobsGroup.Config.Site);t.getAccountDetails(function(e){o(e.LoggedInState)})}}function h(o){S(function(t){if(0===t)return m(),void o(!0);var n="/savedjobs/storage/syncsavedjobs",i={};e.getJSON(n,i).done(function(e){l(e,o)})})}function j(e,o){var t=s_gi(analLib.getSiteId());t.linkTrackVars="eVar23,events",t.linkTrackEvents=e,t.events=e,t.tl(this,"o",o)}var J=[],k="SavedJobsDoneInitialMergeOnLogin",C=!1;return r()&&n(),{get:d,add:c,remove:v,getCount:p,isSaved:a,refreshSavedJobsFromServer:h,getIsCommunicatingWithServer:f,setIsCommunicatingWithServer:b,getLoggedInState:S,trackOnSitecatalyst:j}};var SavedJobs=SavedJobs||{},analLib=analLib||{};window.console||(window.console={},window.console.log=function(){}),SavedJobs.Events=function(e,o,t){function n(e){analLib.fireApplyButtonClick(e.hasClass("ext-url"))}function i(e){var o=parseInt(e.attr("id"));return o}function a(e){var n=i(e);return isNaN(n)||o.getIsCommunicatingWithServer()||(o.setIsCommunicatingWithServer(!0),o.isSaved(n)?o.remove(n,function(t){o.setIsCommunicatingWithServer(!1),t?(e.trigger("update"),analLib.fireJobSavedClick(!1,n,!1)):console.log("Error: unable to remove saved job")}):"0"!==n&&o.add(n,function(i){o.setIsCommunicatingWithServer(!1),i?(e.trigger("update"),analLib.fireJobSavedClick(!0,n,t===!0)):console.log("Error: unable to save job")})),!1}function s(e){e.removeClass("btn-mobile-hover-fix")}function r(e){e.addClass("btn-mobile-hover-fix")}function u(t){if(o.isSaved(i(t))?(t.addClass("saved"),"BUTTON"===t.prop("tagName")&&t.html("Saved")):(t.removeClass("saved"),"BUTTON"===t.prop("tagName")&&t.html("Save")),t.blur(),!l){l=!0;var n=t.attr("id");n.indexOf("_")!==-1&&e("[id^="+i(t)+"]").each(function(){var o=e(this).attr("id");o!==n&&e(this).trigger("update")}),l=!1}}function d(){String.format||(String.format=function(){var e,o;for(e=1;e<arguments.length;e++)o=new RegExp("\\{"+(e-1)+"\\}","gm"),arguments[0]=arguments[0].replace(o,arguments[e]);return arguments[0]});var t=e(".jb-status"),n=e("#navbar-savedjobs"),i=n.length,a=o.getCount(),s=e("#menu_SavedJobslink span").length;if(a>0){e(".icon_saved_jobs").show(),e("#jb-status-count").show();var r=a,u=SavedJobs.Properties.MaxItems;a>u&&(r=u),e("#jb-status-count span").text(r),e("#jb-header-message span").text(r),s||(n.removeClass("navbar-saved-jobs-empty-icon"),n.addClass("navbar-saved-jobs-icon"),i?t.removeClass("jb-status-empty").html(r):1==a?t.removeClass("jb-status-empty").html(String.format(SavedJobs.Properties.FillTextSingular,a)):a>1&&t.removeClass("jb-status-empty").html(String.format(SavedJobs.Properties.FillText,a)))}else s||(n.removeClass("navbar-saved-jobs-icon"),n.addClass("navbar-saved-jobs-empty-icon"),i?t.addClass("jb-status-empty").html("0"):t.addClass("jb-status-empty").html(SavedJobs.Properties.EmptyText)),e(".icon_saved_jobs").hide(),e("#jb-status-count").hide()}function c(){e(".jb-status").bind("update",d),e(".saved-jobs-icon").each(function(o,t){var n=e(t);n.removeClass("disabled"),n.removeAttr("disabled"),n.off("click"),n.off("update"),"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?(n.on("click",function(){return a(n)}),n.on("update",function(){u(n)}),n.on("touchstart",function(){s(n)}),n.on("touchend touchcancel",function(){r(n)})):(n.click(function(){return a(n)}),n.bind("update",function(){u(n)}),n.bind("touchstart",function(){s(n)}),n.bind("touchend touchcancel",function(){r(n)}))}),e(".apply-for-job button[type='submit'].btn-primary").each(function(o,t){var i=e(t);"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?i.on("click",function(){n(i)}):i.click(function(){n(i)})})}function v(o){e(".saved-jobs-icon").trigger("update",o),e(".jb-status").trigger("update")}var l=!1;return{bindEvents:c,triggerEvents:v}},function(e){e(document).ready(function(){window.SavedJobsManager=SavedJobs.Manager(e);var o=SavedJobs.Events(e,window.SavedJobsManager);o.bindEvents();var t=e("#saved-jobs-placeholder");t.length&&window.SavedJobsManager.get(t),window.SavedJobsManager.refreshSavedJobsFromServer(function(e){e&&o.triggerEvents({isInitialUpdate:!0})})})}(jQuery),"undefined"==typeof jQuery.cookie&&(jQuery.cookie=function(e,o,t){if(arguments.length>1&&(null===o||"object"!=typeof o)){if(t=jQuery.extend({},t),null===o&&(t.expires=-1),"number"==typeof t.expires){var n=t.expires,i=t.expires=new Date;i.setDate(i.getDate()+n)}return document.cookie=[encodeURIComponent(e),"=",t.raw?String(o):encodeURIComponent(String(o)),t.expires?"; expires="+t.expires.toUTCString():"",t.path?"; path="+t.path:"",t.domain?"; domain="+t.domain:"",t.secure?"; secure":""].join("")}t=o||{};var a,s=t.raw?function(e){return e}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?s(a[1]):null}),function(e){function o(o,t){var n=null,i="JBM_COOKIE",a=null,s=0,r=768,u=function(){b(function(e){a=e,"undefined"==typeof t?d():t()}),s=G()},d=function(){a.toast.mouseenter(L),a.toast.mouseleave(l),a.toast.click(f),"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?e(".saved-jobs-icon").on("update",c):e(".saved-jobs-icon").bind("update",c),e(window).scroll(v)},c=function(o,t){var n=G();if(s!==n){p(n),g(e(this),a.title,n);var i=a.toast;!J(i)||"undefined"!=typeof t&&t.isInitialUpdate||k(i),s=n}},v=function(){var e=a.toast;w(e)&&J(e)},l=function(){E(o.mouseOutTimeout)},f=function(){a.toast.hide()},b=function(t){window.SavedJobsManager.getLoggedInState(function(n){var i="";i+='<div id="saved-job-toast" style="display:none">',i+='  <div id="saved-job-toast-title">'+o.savedJobText+"</div>",i+='  <div id="saved-job-toast-link">',i+='      <a href="/savedjobs/">View saved jobs</a>',i+="  </div>",i+=n>0?'  <div id="saved-job-toast-text">'+o.loggedInText+"</div>":'  <div id="saved-job-toast-text">'+o.notLoggedInText+"</div>",i+="</div>",e("body").append(i),t({toast:e("#saved-job-toast"),jobCount:e("#saved-job-toast-jobcount"),title:e("#saved-job-toast-title"),link:e("#saved-job-toast-link")})})},p=function(e){e>-1?a.jobCount.html(e+"&nbsp;"):a.jobCount.html("")},g=function(e,t,n){e.hasClass("saved")===!0?t.text(n+" "+o.savedJobText):t.text(o.removedJobText)},m=function(e,o){var t=e.outerWidth(),n=0,i=T();return n=i<r?S(t,i):h(t,o)},S=function(e,o){var t=0,n=o-e;return n>0&&(t=n/2),t},h=function(e,o){var t=0,n=o.offset();return n.left>0&&(t=n.left-e+o.width()),t},j=function(e){var o=0,t=y(e);return t&&(o=C(e)+10),o},J=function(e){var o=x();if(null==o)return!1;var t=m(e,o),n=j(o);return e.css("top",n),e.css("left",t),!0},k=function(e){L(),w(e)?e.show():e.slideDown(),E(o.visibleForTimeout)},C=function(o){var t=e(window).scrollTop(),n=o.offset();return n.top+o.outerHeight()-t},y=function(o){var t=e(window).scrollTop(),n=e(o).offset().top+e(o).outerHeight();return n>=t},T=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},x=function(){var o=e("#navbar-savedjobs");return 0===o.length&&(o=e(".jb-status")),o.length>0?o:null},w=function(e){return e.is(":visible")===!0},I=function(){a.toast.slideUp()},L=function(){null!=n&&clearTimeout(n)},E=function(e){var o=a.toast;1===o.length&&(n=setTimeout(I,e))},G=function(){var o=e.cookie(i);return null!==o?M(o):-1},M=function(e){if(e){var o=e.split("|");if(o.length>0&&null!==o[0]){var t=o[0].split(",");return t.length}}return-1};return u(),{bindEvents:d}}e(document).ready(function(){var e={visibleForTimeout:3e3,mouseOutTimeout:1e3,savedJobText:"Saved job(s)",removedJobText:"Removed job",notLoggedInText:'To view your saved jobs on any device, <a href="/Authenticated/Login.aspx">log&nbsp;in</a> or <a href="/Authenticated/UnAuth/NewUser.aspx">register</a>.',loggedInText:"Log in on any device to view your saved jobs."},t=new o(e);window.Toast=t})}(jQuery);
//# sourceMappingURL=savedjobs.min.js.map
